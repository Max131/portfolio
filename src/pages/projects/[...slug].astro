---
import { getCollection, render } from "astro:content";
import { Image } from "astro:assets";
import Layout from "@layouts/Project.astro";

export async function getStaticPaths() {
  const projects = await getCollection("projects");
  return projects.map((post) => ({
    params: { slug: post.slug },
    props: { post },
  }));
}

const { post } = Astro.props;
const { Content } = await render(post);
const images = post.data.images || [];
const IMAGES_PATH = "/images/projects/";
---

<Layout title={post.data.title}>
  <div class="content text-lg mt-12 single">
    <div class="md:grid grid-cols-2 gap-8">
      <div>
        <Content />
        <a
          class="text-sm font-bold p-4 bg-cyan-500 text-white rounded-lg inline-block mt-8 focus-visible:ring-6 ring-cyan-500"
          href={post.data.link}
          target="_blank"
          rel="noopener noreferrer">Visitar proyecto</a
        >
      </div>

      <div class="flex flex-col gap-8 mt-12 md:mt-0">
        <img
          src={`${IMAGES_PATH}${post.data.thumbnail}`}
          alt={`${post.data.title} thumbnail`}
          class="w-full h-auto rounded shadow-lg"
        />

        {
          images.map((image) => (
            <Image
              class="w-full h-auto rounded shadow-lg object-cover"
              src={`${IMAGES_PATH}${post.data.dirimages}/${image}`}
              width={496}
              height={248}
              alt={`Vista previa de ${post.data.title}`}
              class="w-full h-auto rounded"
            />
          ))
        }
      </div>
    </div>
  </div>
</Layout>
